Exploratory Data Analysis by Rob Hickey
========================================================


```{r echo=FALSE, message=FALSE, warning=FALSE, packages}

# install.packages("ggplot2", dependencies = T) 
# install.packages("knitr", dependencies = T)
# install.packages("dplyr", dependencies = T)
# install.packages("gridExtra")

library(ggplot2)
library(gridExtra)
library(dplyr)
library(grid)
library(tidyr)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Load the Data
rw <- read.csv('wineQualityReds.csv')
```

The dataset I am using has 1599 instances of bottles of red wine and a number
variables that capture characteristics of those wines (11) and one variable that
captures the quality of the wine on a scale of 1-10 as measured as the median
of at least 3 evaluations made by wine experts. 

# Univariate Plots Section


```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw)
```

I wanted to see all of the varaibles of my data set and see the interquartile ranges for later use.  

#### pH Plot of Data Set

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(aes(x = pH), data = rw) +
  geom_histogram(binwidth = .01, color = 'black', fill = 'red')
```
```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw$pH)
```

I was interested in getting a sense of the shape of the varaible in the data for pH. Comparing the mean value of pH for the wines in this data set to the average pH of red wines I found doing a Google search (between 3.3 and 3.6), the mean pH of the wines in our data set appears consistent with that of red wines in general. 

#### Residual Sugar Plot of Data Set

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = residual.sugar), data = rw) +
  geom_histogram(binwidth = .1, color = 'black', fill = 'red')
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw$residual.sugar)
```

I was interested in getting a sense of the shape of the varaible in the data for residual sugar. Later in the analysis I wanted to see how the amount of residual sugar in the wines affected the quality scores for the wines. I suspected that a certain range of sweetness (not too sweet but sweet enough) in wines would tend to have higher scores. 

#### Chloride Plot of Data Set

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = chlorides), data = rw) +
  geom_histogram(binwidth = .003, color = 'black', fill = 'red')
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw$chlorides)
```

I was interested in getting a sense of the shape of the varaible in the data for salts. Later in the analysis I wanted to see how the amount of salts in the wines affected the quality scores for the wines. I suspected that a certain range of saltiness (not too salty but salty enough) in wines would tend to have higher scores. 

#### Alcohol Plot of Data Set

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = alcohol), data = rw) +
  geom_histogram(binwidth = .1, color = 'black', fill = 'red')
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw$alcohol)
```

I was interested in getting a sense of the shape of the varaible in the data for alcohol. Later in the analysis I wanted to see how the amount of alcohol in the wines affected the quality scores for the wines. I suspected that a certain range of alcohol (not too much but not too little) in wines would tend to have higher scores. 

#### Quality Plot of Data Set

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = quality), data = rw) +
  geom_histogram(binwidth = 1, color = 'black', fill = 'red')
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw$quality)
```

Here, I just wanted to get a general sense of what shape of the scored for quality looked like. Interestingly, out of 1599 observations, no wines received a 9 or a 10 nor did any of the wines in this data set receive a 0, 1, 2, or 3. I suspect these is some psychological phenomenon going here where raters tend to be anchored to the average of all possible scores they could receive. There is an interesting analysis of anchoring in Daniel Kahneman's book, Thinking, Fast and Slow.

#Subsetting the Data

#### Looking at the Fourth and First Quartiles of the pH Data 

```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_pH_TQ <- subset(rw, rw$pH>3.4)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_pH_TQ$quality)
nrow(rw_pH_TQ)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_pH_FQ <- subset(rw, rw$pH<3.21)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_pH_FQ$quality)
nrow(rw_pH_FQ)
```

It appears at first glance that high and low levels of acidity tend to receive similar quality scores. We chose the first and third quartiles as figures here so we would have approximately the same sample size. 

#### Looking at the Fourth and First Quartiles of the Residual Sugar Data 

```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_RS_TQ <- subset(rw, rw$residual.sugar>2.6)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_RS_TQ$quality)
nrow(rw_RS_TQ)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_RS_FQ <- subset(rw, rw$residual.sugar<1.9)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_RS_FQ$quality)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
nrow(rw_RS_FQ)
```


It appears at first glance that high and low levels of residual sugar tend to receive similar quality scores. We chose the first and third quartiles as figures here so we would have approximately the same sample size. 

#### Looking at the Fourth and First Quartiles of the Chlorides (Salts) Data 

```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_C_TQ <- subset(rw, rw$chlorides>.09)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_C_TQ$quality)

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
nrow(rw_C_TQ)
```


```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_C_FQ <- subset(rw, rw$chlorides<.07)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_C_FQ$quality)

```

```{r echo=FALSE, message=FALSE, warning=FALSE}
nrow(rw_C_FQ)
```


It appears at first glance that high and low levels of salt tend to receive similar quality scores. We chose the first and third quartiles as figures here so we would have approximately the same sample size.

#### Looking at the Fourth and First Quartiles of the Total Sulfur Dioxide Data 

```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_TSD_TQ <- subset(rw, rw$total.sulfur.dioxide>62)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_TSD_TQ$quality)
nrow(rw_TSD_TQ)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_TSD_FQ <- subset(rw, rw$total.sulfur.dioxide<22)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_TSD_FQ$quality)
nrow(rw_TSD_FQ)
```

#### Looking at the Fourth and First Quartiles of the Free Sulfur Dioxide Data 

```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_FSD_TQ <- subset(rw, rw$free.sulfur.dioxide>21)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_FSD_TQ$quality)
nrow(rw_FSD_TQ)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_FSD_FQ <- subset(rw, rw$free.sulfur.dioxide<7)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_FSD_FQ$quality)
nrow(rw_FSD_FQ)
```


#### Looking at the Fourth and First Quartiles of the Alcohol Data 


```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_A_TQ <- subset(rw, rw$alcohol>11.1)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_A_TQ$quality)
nrow(rw_A_TQ)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
rw_A_FQ <- subset(rw, rw$alcohol<9.5)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
summary(rw_A_FQ$quality)
nrow(rw_A_FQ)
```

We see some divergence in the quality scores for those with high and low levels of alcohol. We chose the first and third quartiles as figures here so we would have approximately the same sample size.

```{r echo=FALSE, message=FALSE, warning=FALSE}
alcohol_TQ <- ggplot(aes(x = quality), data = subset(rw, rw$alcohol>10)) +
  geom_histogram(binwidth = 1, color = 'black', fill = 'red') +
  theme_update(plot.title = element_text(hjust = 0.5)) +
  ggtitle('Over 10%')

alcohol_FQ <- ggplot(aes(x = quality), data = subset(rw, rw$alcohol<9.5)) +
  geom_histogram(binwidth = 1, color = 'black', fill = 'blue') +
  theme_update(plot.title = element_text(hjust = 0.5)) +
  ggtitle('Under 9.5%')

grid.arrange(alcohol_TQ, alcohol_FQ, ncol= 2, top = 'Comparison of Quality Scores for Wines with Alcohol Content Over 10% and for Alcohol Under 9.5%')
```

We can see here that the scores look to be higher for the wines with an alcohol 
content of over 10%. 

```{r echo=FALSE, message=FALSE, warning=FALSE}

# install.packages("GGally")
library(GGally)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
theme_set(theme_minimal(5))

set.seed(102)
rw_scatter_matrix <- rw[, (2:13)]
names(rw_scatter_matrix)
ggpairs(rw_scatter_matrix[sample.int(nrow(rw_scatter_matrix), 1000), ])
```

# Univariate Analysis


### What is the structure of your dataset?

The dataset contains 1599 data points - each one is a specific type of red wine 
- and 13 variables (11 continuous variables and 1 discrete
variable) for each wine that describes some attribute of the wine. The one discrete 
variable is the quality of the wine. 

Some other things to note about the dataset:

- The median pH of the wines is consistent with the average pH of red wines in
general.
- The median amount of residual sugar is around 2.2 g/dm^3, but we have a few wines
that are between 12-16 g/dm^3 of residual sugar. 
- Almost all of the wines have an alcohol content of between 9% and 13%.

### What is/are the main feature(s) of interest in your dataset?

The main feature of interest in this dataset that I wish to investigate is
how all of the 11 continuous variabes impact the one discrete variable (perceived
quality of the wine). I am very interested to know whether there is any relationship 
between individual variables, or combinations of variables, and the perceived quality.
If I am not able to find any relationship, it may support the argument that wine
quality is more subjective than a sommelier would care to admit. Conversely, if I
am able to find a relationship between a variable or combination of variables 
and quality, we may be able to develop a predicitive model for wine quality scores.

### What other features in the dataset do you think will help support your 
### investigation into your feature(s) of interest?

After subsetting the data above and looking at how the first and fourth quartiles
of different variables impact quality scores (pH, residual sugar, salt, total sulfur 
dioxide, free sulfur dioxide, and alcohol), I found that the percentage of alcohol,
by volume, the amount of total sulfur dioxide, and the amount of free sulfur dioxide
might impact the quality scores of wines. I beleive it will be very interesting 
to look at the data from a multivariate perspective in that section of this
analytical report.

### Did you create any new variables from existing variables in the dataset?

I did not create any new variables from existing variables in the dataset; 
however, as I go further in the analysis, I will see if the generation of new
variables will help my analysis. 


### Of the features you investigated, were there any unusual distributions? 
### Did you perform any operations on the data to tidy, adjust, or change the form 
### of the data? If so, why did you do this?

I did subset the data to look at the impact that certain ranges of values (first
and fourth quartiles) might have on perceived wine quality. Probably the most 
interesting thing I did to the data was perform a scatter matrix on the data to
see if there were any interesting relationships in the data that I was missing.

By doing this, I found some expected and not to expected moderate to strong
correlation coefficients as follows between the variables:

- Fixed acidity to citric acid: .651 (This is potentially expected since these both 
measure acids.)
- Volatile aciditiy to citric acid: -.538 (I have no insight into why this
relationship might exist. maybe one type of acid can convert into the other?)
- pH to citric acid: -.541 (This seems logical since pH goes down as the amount 
of acid goes up.)
- Free sulfur dioxide to total sulfur dioxide: .66 (This makes perfect sense since
total sulfur dioxide presumably includes free sulfur dioxide.)
- Alcohol to density: -.457 (This makes sense since alcohol is less dense than 
water, so as alcohol goes up, density should go down and result in a negative
correlation.)
- Density to fixed acidity: .67 (I know density here could be a function of 
alcohol content, with greater density possibly meaning less alcohol and the inverse.
Why would there be a relationship between less alcohol (greater density)
and more fixed acidity? Does the conversion of components of the wine to alcohol result 
in the conversion of some acidic components to more basic components? Or maybe
the greater the amount of dissolved acids in the water in the wine, the greater
the density of the wine [assuming the acids are more dense than water].) 
- pH to fixed acidity: -.667 (This seems logical since pH goes down as the amount 
of acid goes up.)
- Chlorides to sulfates: .456 (I'm not sure why there would be a moderate 
correlation here.)

Finally, I found there to be a moderately strong correlation (.481) between the
quality score and alcohol content in the scatter matrix. 


# Bivariate Plots Section

In the bivariate plots section, I wanted to do some further exploration of the
relationships that seemed interesting to me in the unvariate section. These 
relationships included the following:

#### Relationship Between Fixed Acidity and Citric Acid

```{r echo=FALSE, message=FALSE, warning=FALSE}

ggplot(aes(x = fixed.acidity, y = citric.acid), data = rw) +
  geom_jitter(color = 'red') +
  geom_smooth(method = 'lm', color = 'blue')

```

#### Relationship Between Free Sulfur Dioxide and Total Sulfur Dioxide

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = free.sulfur.dioxide, y = total.sulfur.dioxide), data = rw) +
  geom_jitter(color = 'red') +
  geom_smooth(method = 'lm', color = 'blue')
```

#### Relationship Between Density and Fixed Acidity

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = density, y = fixed.acidity), data = rw) +
  geom_jitter(color = 'red') +
  geom_smooth(method = 'lm', color = 'blue')
```

#### Relationship pH and Fixed Acidity

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = pH, y = fixed.acidity), data = rw) +
  geom_jitter(color = 'red') +
  geom_smooth(method = 'lm', color = 'blue')
```

#### Relationship Between Chlorides and Sulfates

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = chlorides, y = sulphates), data = rw) +
  geom_jitter(color = 'red', alpha = 0.1) +
  geom_smooth(method = 'lm', color = 'blue')
```

## More Interesting Relationships (To Me)

#### Relationship Between Quality and Total Sulfur Dioxide

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = quality, y = total.sulfur.dioxide), data = rw) +
  geom_jitter(color = 'red') +
  geom_smooth(method = 'lm', color = 'blue')

```

I was very interested here in seeing the mean, median, and interquartile ranges
of total sulfur dioxide for each quality rating. There does appear to be an inverse 
relationship between total sulfur dioxide and quality. It is possible therefore 
that sulfur is something the wine tasters can taste, and greater amounts of it negativly
affects their scores.

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = quality, y = total.sulfur.dioxide, group = quality), data = rw) +
    geom_boxplot(color="#3366FF", varwidth = TRUE, fill = "red", outlier.color = "green", outlier.shape = 1) +
    stat_summary(fun.y = mean, geom = 'point', shape = 4)
   
```

#### Relationship Between Quality and Alcohol Levels

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = quality, y = alcohol), data = rw) +
  geom_jitter(color = 'red') +
  geom_smooth(method = 'lm', color = 'blue')

```

I was very interested here in seeing the mean, median, and interquartile ranges
of alcohol for each quality rating. There does appear to be a positive 
relationship between alcohol and quality rating. It is possible therefore 
that alcohol is something the wine tasters can taste, and greater amounts of it positively
affects their scores.

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = quality, y = alcohol, group = quality), data = rw) +
    geom_boxplot(color="#3366FF", varwidth = TRUE, fill = "red", outlier.color = "green", outlier.shape = 1) +
    stat_summary(fun.y = mean, geom = 'point', shape = 4)
   
```

#### Relationship Between Quality and Volatile Acidity

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = quality, y = volatile.acidity), data = rw) +
  geom_jitter(color = 'red') +
  geom_smooth(method = 'lm', color = 'blue')

```

I was very interested here in seeing the mean, median, and interquartile ranges
of volatile acidity for each quality rating. There does appear to be an inverse 
relationship between volatile acidity and quality rating. It is possible therefore 
that volatile acidity is something the wine tasters can taste, and greater amounts of it negatively
affects their scores.

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = quality, y = volatile.acidity, group = quality), data = rw) +
    geom_boxplot(color="#3366FF", varwidth = TRUE, fill = "red", outlier.color = "green", outlier.shape = 1) +
    stat_summary(fun.y = mean, geom = 'point', shape = 4)
   
```


## Failed Attempt at Coding

```{r echo=FALSE, message=FALSE, warning=FALSE}
quality_description_data<-rw
```


```{r echo=FALSE, message=FALSE, warning=FALSE}
is.numeric(quality_description_data$quality)
```

```{r}

# quality_description_data$description <- if (quality_description_data$quality==0) {
#  quality_description_data$description = "Is this even possible?"
# } else if (quality_description_data$quality==1) {
#  quality_description_data$description='Wretched'
# } else if (quality_description_data$quality==2) {
#   quality_description_data$description='Pretty Bad'
# } else if (quality_description_data$quality==3) {
#   quality_description_data$description='Meh'
# } else if (quality_description_data$quality==4) {
#    quality_description_data$description='Drinkable'
# } else if (quality_description_data$quality==5) {
#   quality_description_data$description='Decent Table Wine'
# } else if (quality_description_data$quality==6) {
#   quality_description_data$description='Good Value'
# } else if (quality_description_data$quality==7) {
#   quality_description_data$description='Fancy Restaurant Wine'
# } else if (quality_description_data$quality==8) {
#   quality_description_data$description='Classy Stuff!'
# } else if (quality_description_data$quality==9) {
#   quality_description_data$description='About As Good As It Gets'
# } else if (quality_description_data$quality==10) {
#   quality_description_data$description='Perfection is Impossible'
# } else {quality_description_data$description='No Data'
# }
```

I spent an incredible amount of time (around 3 hours) trying to get the code 
to work above. I read through forums and Udacity discussion boards. Then I tried
to take a different approach below to try to give some description to each of
the quality ratings. I know that these are not accurate descriptions of the 
quality ratings, but I wanted to give them some meaning instead of a number because
in the real world, someone looking at this data would want to know what they mean, 
I think.


```{r echo=FALSE, message=FALSE, warning=FALSE}
quality_description_data$description <- cut(quality_description_data$quality, breaks = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11),right = FALSE, labels = c("Is this even possible?", "Wretched", "Pretty Bad", "Meh", "Drinkable", "Decent Table Wine", "Good Value", "Fancy Restaurant Wine", "Classy Stuff!", "About As Good As It Gets", "Perfection is Impossible"))
```

I then reproduced the boxplot using those descriptions I developed using the cut()
function. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = description, y = alcohol, group = quality), data = quality_description_data) +
    geom_boxplot(color="#3366FF", varwidth = TRUE, fill = "red", outlier.color = "green", outlier.shape = 1) +
    stat_summary(fun.y = mean, geom = 'point', shape = 4)
```

# Bivariate Analysis


### Talk about some of the relationships you observed in this part of the
### investigation. How did the feature(s) of interest vary with other features in 
### the dataset?

With the examination of the quality rating being the dependent variable and the
other 11 variables being the independent variables, three independent variables
are particularly interesting: alcohol levels, total sulfur dioxide, and volatile
acidity.

As alcohol increases, quality ratings appear to increase.
As total sulfur dioxide increases, quality ratings appear to decrease. 
As volatile acidity increases, quality ratings appear to decrease. 

### Did you observe any interesting relationships between the other features 
### (not the main feature(s) of interest)?

Two other interesting relationships were a positive relationship between 
density and fixed acidity as well as a positive relationship between chlorides
and sulfates.

### What was the strongest relationship you found?


While the positive relationship between alcohol content and quality was the strongest,
I am the most interested in the positive relationship between volatile acidity
and quality score.

In the multivariate plots section I really want to look at the interation between
quality, alcohol content, total sulfur dioxide levels, and volatile acidity. 
In particular, I want to see if the best wines tend to be those with high alcohol content and low
total sulfure dioxide and volatile acidity.  

# Multivariate Plots Section

First, let's create categorical variables for all the points of interest so
we can plot against them. We have already done this for quality when we created
a new variable above, so let's do this with alcohol content, total sulfur dioxide,
and volatile acidity. We will use the min, mean, max and two interquartile values
to create the bucket for each variable.

```{r echo=FALSE, message=FALSE, warning=FALSE}
quality_description_data$Alcohol.bucket <- cut(quality_description_data$alcohol, c(8.4, 9.5, 10.42, 11.1, 14.9))
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
quality_description_data$TSD.bucket <- cut(quality_description_data$total.sulfur.dioxide, c(6, 22, 46.47, 62, 289))
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
quality_description_data$VA.bucket <- cut(quality_description_data$volatile.acidity, c(.12, .39, .5278, .64, 1.58))
```


#### Relationship Between Quality, Alcohol, and Total Sulfur Dioxide

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = 2 * round(alcohol/2), y = quality), 
       data = subset(quality_description_data, !is.na(TSD.bucket))) +
  geom_line(aes(color = TSD.bucket), stat = 'summary', fun.y = mean)
```

When we look at alcohol content on the x axis versus the quality on the y axis,
colored by interquartile ranges of total sulfur dioxide levels, we can see that
quality seems to increase as alcohol content increases for all total
sulfur dioxide buckets; however, it seems that, in general. the mean quality
rating of wine at the same alcohol level tends to be less for those with 
more total sulfur dioxide (the purple line).

```{r echo=FALSE, message=FALSE, warning=FALSE}
table(quality_description_data$quality, useNA = 'ifany')
```

It would seem it is only worth looking at data for wines with a quality with 5, 6,
or 7 here because the same sizes for the other quality levels are so low as to
possibly be meaningless. 

Also, looking at the next graph, I would say that the graph above would not be 
relable below an alcohol content of 9% and above 12% because there is a dearth
of data below and above these levels. 

With the inclusion of only these areas, we can see that wines with high
total sulfur content tend to have lower quality scores with alcohol content
held constant. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = alcohol, y = quality), data = subset(quality_description_data, !is.na(TSD.bucket))) +
  geom_jitter(aes(color = TSD.bucket), alpha = .8)
```

Looking at the individual data points here, we can see that as wines increase
in alcohol content and quality, more of them seem to be red and green (lower
total sulfur dioxide) rather than blue and red (higher sulfur dioxide).
However, there are a few outliers in the upper right corner of the graph above.
Perhaps the high alcohol content overcame the sulfur content when being assessed
for quality.

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = alcohol, y = total.sulfur.dioxide), data = quality_description_data) +
  geom_point(aes(color = description), alpha = .5) +
  geom_smooth(method = 'lm', color = 'blue') +
  xlim(8, quantile(quality_description_data$alcohol, .99)) +
  ylim(0, quantile(quality_description_data$total.sulfur.dioxide, .99))
```

And here, I wanted to look at the data from another perspective. I can see here
that as alcohol content increases and total sulfur dioxide decreases, that
the quality ratings tend to improve and go from green to teal to blue, with
increasing amount of pink as the alcohol increases and total sulfur dioxide
decreases. 

```{r echo=FALSE, message=FALSE, warning=FALSE}

cor.test(quality_description_data$alcohol,quality_description_data$total.sulfur.dioxide, conf.level = 0.99)
```

#### Relationship Between Quality, Alcohol, and Volatile Acidity

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = 2 * round(alcohol/2), y = quality), data = subset(quality_description_data, !is.na(VA.bucket))) +
  geom_line(aes(color = VA.bucket), stat = 'summary', fun.y = mean)
```

When we look at alcohol content on the x axis versus the quality on the y axis,
colored by interquartile ranges of volatile acidity levels, we can see that
quality seems to increase as alcohol content increases for all volatile acidity
buckets; however, it seems that, in general. the mean quality
rating of wine at the same alcohol level tends to be less for those with 
more volatile acidity (the purple and green lines).


Also, looking at the next graph, I would say that the graph above would not be 
relable below an alcohol content of 9% and above 12% because there is a dearth
of data below and above these levels. 

With the inclusion of only these areas, we can see that wines with high
volatile acidity tend to have lower quality scores with alcohol content
held constant. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = alcohol, y = quality), data = subset(quality_description_data, !is.na(VA.bucket))) +
  geom_jitter(aes(color = VA.bucket), alpha = .7)
```

Looking at the individual data points here, we can see that as wines increase
in alcohol content and quality, more of them seem to be red and green (lower
volatile acidity) rather than blue and red (higher volatile acidity).


#### Relationship Between Volatile Acidity, Total Sulfur Dioxide, and Quality

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = total.sulfur.dioxide, y = volatile.acidity), 
       data = subset(quality_description_data, !is.na(VA.bucket))) +
  geom_jitter(aes(color = description), alpha = .7) +
  xlim(0, quantile(quality_description_data$total.sulfur.dioxide, .95)) +
  ylim(0, quantile(quality_description_data$total.volatile.acidity, .95))
```

Finally, I wanted to look at total sulfur dioxide versus volatile acidity,
colored by quality, to see if there might be a relationship between these
variables. If there is a relationship between these variables it might
not be the case that there directy impact the dependent variable (quality score)
but instead that one affects the other and that in turn affects the dependent
variable.

```{r echo=FALSE, message=FALSE, warning=FALSE}
cor.test(quality_description_data$volatile.acidity, quality_description_data$total.sulfur.dioxide)
```

Since there does not appear to be a correlation between the three of them, we may
be able to say that each of them affects the dependent variable directly (or 
perhaps that a lurkng variable affects one of these variables which in turn affects
the dependent variable.

However it is interesting to note as a confirmation that wines in the lower left of the 
graph tend to be pink and blue (higher quality score), and then the dots turn 
teal and green (lower quality score) as we go up and to the right. 

#### Relationship Between Volatile Acidity, Total Sulfur Dioxide, and Alcohol

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = total.sulfur.dioxide, y = volatile.acidity), 
       data = subset(quality_description_data, !is.na(VA.bucket))) +
  geom_jitter(aes(color = Alcohol.bucket), alpha = .7) +
  xlim(0, quantile(quality_description_data$total.sulfur.dioxide, .95)) +
  ylim(0, quantile(quality_description_data$total.volatile.acidity, .95))
```

I wanted to see if there was a relationship between total sulfur dioxide,
volatile acidity, and alcohol content before doing my final analysis. I wanted to
see if there three variables were indepedent of each other in order to know
if quality is affected by each of them indvidually or if one has an affect
on another that in turn affects quality. These appear to be fairly indepedent to 
me, and the correlation coefficient above seem to bear that out. There is a very 
weak inverse correlation between total sulfur dioxide and alcohol and volatile 
acidity and alcohol (which is why there may be slightly more purple in the bottom
left of the graph), but it did not seem interesting enough to probe further.


# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the 
### investigation. Were there features that strengthened each other in terms of 
### looking at your feature(s) of interest?

It seems that lower total sulfur dioxide, lower volatile acidity, and higher 
alcohol content tends to increase the quality of wine.  

### Were there any interesting or surprising interactions between features?

What seems interesting for further investigation would be to see how
alcohol content, total sulfur dioxide, and volatile acidity are correlated, using
a larger dataset. I feel like the weak correlation between total sulfur dioxide 
and alcohol and volatile acidity and alcohol. I'd like to know if these correlations
are weakened or strengthened in a larger data set. I want to know this
to see if each variable affects quality directly or once variable acts on 
another and in turn affects quality. 

------

# Final Plots and Summary


### Plot One
```{r echo=FALSE, message=FALSE, warning=FALSE}
alcohol_TQ <- ggplot(aes(x = quality), data = subset(rw, rw$alcohol>10)) +
  geom_histogram(binwidth = 1, color = 'black', fill = 'red') +
  theme_update(plot.title = element_text(hjust = 0.5)) +
  ggtitle('Over 10% Alcohol') +
  theme(axis.text=element_text(size=14),
        axis.title=element_text(size=14,face="bold")) + 
  theme(plot.title = element_text(size = 10, face = "bold"))
  

alcohol_FQ <- ggplot(aes(x = quality), data = subset(rw, rw$alcohol<9.5)) +
  geom_histogram(binwidth = 1, color = 'black', fill = 'blue') +
  theme_update(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text=element_text(size=14),
        axis.title=element_text(size=14,face="bold")) +
  ggtitle('Under 9.5% Alcohol') +
  theme(plot.title = element_text(size = 10, face = "bold"))
  

grid.arrange(alcohol_TQ, alcohol_FQ, ncol= 2, top = textGrob("Comparison of Quality Scores for Wines with Alcohol Content Over 10% and for Alcohol Under 9.5%", gp=gpar(fontsize=12,font=8)))
```

Comparison of Quality Scores for Wines with Alcohol Content Over 10% and for Alcohol Under 9.5%



### Description One

The histogram above shows why alcohol content will be an interesting variable
for later exploratoy analysis.

### Plot Two
```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = quality, y = volatile.acidity), data = rw) +
  geom_jitter(color = 'red', alpha = .5) +
  geom_smooth(method = 'lm', color = 'blue') +
  ggtitle('Quality Versus Volatile Acidity') +
  theme(plot.title = element_text(size = 30, face = "bold")) +
  theme(axis.text=element_text(size=14), axis.title=element_text(size=14,face="bold")) +
  labs(x = "Quality", y = "Volatile Acidity") 
  

```

### Description Two

I wanted to show why the relationship between volatile acidity and quality would 
be an important relationship to measure in the multivariate analysis section. 


### Plot Three


```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(aes(x = alcohol, y = total.sulfur.dioxide), data = quality_description_data) +
  geom_point(aes(color = description), alpha = .5) +
  geom_smooth(method = 'lm', color = 'blue') +
  xlim(8, quantile(quality_description_data$alcohol, .99)) +
  ylim(0, quantile(quality_description_data$total.sulfur.dioxide, .99)) +
  ggtitle('Alcohol Versus Total Sulfur Dioxide, Colored by Description of Quality') +
  theme(plot.title = element_text(size = 12, face = "bold")) +
  theme(axis.title=element_text(size=14,face="bold"), legend.title=element_text(size=8,face="bold")) +
  labs(x = "Alcohol", y = "Total Sulfur Dioxide", col = "Description of Quality") 
```


### Description Three

With this plot, I, wanted to show how as alcohol content increased and total sulfur
dioxide decreased, we tended to get more wines that were rated with higher quality. 

------

# Reflection


The struggle with exploratory data analysis (and by extension, this exercise)
is figuring out which  independent variables have explanatory power 
for the dependant variable and are interesting in that they were not expected to 
have some explanatory power at the outset. 


In this analysis, I found some moderately strong correlations between variables 
that did not really help understand the  dependant variable (quality) in focus.
Another struggle was trying to understand whether the variables I think were 
influencing quality were all influencing indepedently or if there were come 
confounding variables in the dataset. For example, does alcohol affect quality
score directly, or does it affect total sulfur dioxide, which then affects the
quality score? Or does volatile acidity affect alcohol content, which in turn
affect quality score. In the analysis above, I tried to look for these
confounding variables by seeing if there were signifiant correlations
between alcohol levels, total sulfur dioxide, and volatily acidity. Since I 
did not find strong correlations between any two of these, I'm assuming
that all three of them may be able to affect the quality score directly in some way.

I think I managed to find three independent variables fairly well that have some
explanatory power for quality. I was surpised that the seemingly largest predictor
of quality score was alcohol content though. 

Since I was not able to find any very strong correlations between quality score
and individual variables in the data, it may be that predicting quality a combination of
variables simultaneously rather than being significantly explained by one.

I think a larger dataset of wines and a larger number of wine experts 
tasting each wine is needed to create a robust datset. In such a dataset,
a predictive model could be created that could explain a good deal of
the variance in quality scores and  should possibly include alcohol, total sulfur dioxide,
and volatily acidity as predictors (in addition to others) since there were some
signs that these three in tandem might help predict quality score.

However, even based on an extremely large dataset, I'm  not sure a predictive model
would ever be very accurate due to the subjective nature of the quality scores.
Such variance in perception and the psychology of the taster is not accounted 
for in this dataset and thus cannot be included in a predictive model for scores 
in order to properly refine it. 










